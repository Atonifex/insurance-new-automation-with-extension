"use strict";(()=>{var a={currentCaseId:null,currentCase:null,autofillState:"idle",currentHost:null,detectedCarrier:null,lastError:null,currentPageIdentifier:null};chrome.runtime.onMessage.addListener((t,e,r)=>{var o,i,l,n;switch(console.log("[Background] Received message:",t.type,"from:",(o=e.tab)==null?void 0:o.url),t.type){case"MFA_DETECTED":a.autofillState="paused",a.lastError="MFA verification required",(i=e.tab)!=null&&i.id&&(chrome.action.setBadgeText({text:"MFA",tabId:e.tab.id}),chrome.action.setBadgeBackgroundColor({color:"#D97706",tabId:e.tab.id})),r({received:!0});break;case"PAGE_COMPLETED":let c=t.payload;a.currentPageIdentifier=c.pageId,a.lastError=null,r({received:!0});break;case"AUTOFILL_ERROR":let d=t.payload;a.autofillState="error",a.lastError=d.message,(l=e.tab)!=null&&l.id&&(chrome.action.setBadgeText({text:"!",tabId:e.tab.id}),chrome.action.setBadgeBackgroundColor({color:"#DC2626",tabId:e.tab.id})),r({received:!0});break;case"AUTOFILL_COMPLETE":a.autofillState="completed",a.lastError=null,(n=e.tab)!=null&&n.id&&(chrome.action.setBadgeText({text:"\u2713",tabId:e.tab.id}),chrome.action.setBadgeBackgroundColor({color:"#059669",tabId:e.tab.id})),r({received:!0});break;case"GET_STATE":r({state:a});break;default:r({error:"Unknown message type"})}return!0});chrome.tabs.onRemoved.addListener(t=>{chrome.action.setBadgeText({text:"",tabId:t})});chrome.tabs.onUpdated.addListener((t,e)=>{e.status==="loading"&&chrome.action.setBadgeText({text:"",tabId:t})});chrome.runtime.onInstalled.addListener(t=>{t.reason==="install"?console.log("[Background] Extension installed"):t.reason==="update"&&console.log("[Background] Extension updated to version:",chrome.runtime.getManifest().version)});console.log("[Background] Service worker initialized");})();
